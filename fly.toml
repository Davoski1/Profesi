# Fly.io Configuration for PROFESI
# Using Dockerfiles in each service directory

app = "profesi-disaster-prediction"
primary_region = "iad"

[build]
  builder = "docker"

[env]
  FLASK_ENV = "production"
  POSTGRES_USER = "profesi_user"
  POSTGRES_PASSWORD = "profesi123"
  POSTGRES_DB = "profesi_db"
  DATABASE_URL = "postgresql://profesi_user:profesi123@postgres:5432/profesi_db"

[[services]]
  protocol = "tcp"
  internal_port = 3000
  ports = [{handlers = ["http"], port = 80}, {handlers = ["tls", "http"], port = 443}]

[[services]]
  protocol = "tcp"
  internal_port = 8000
  ports = [{handlers = ["http"], port = 8000}]

[[services]]
  protocol = "tcp"
  internal_port = 5432
  ports = [{handlers = [], port = 5432}]

[[services]]
  protocol = "tcp"
  internal_port = 5050
  ports = [{handlers = ["http"], port = 5050}]

[http_service]
  internal_port = 8000
  force_https = true

[[vm]]
  cpu_kind = "shared"
  cpus = 1
  memory_mb = 1024